-- GET MOST PLAYED SONGS IN TOTAL SESSIONS ACCORDING TO THE NUMBER OF USERS WITH THEIR LENGHT, PAID STATUS, ARTIST NAME AND RANK 

SELECT * , DENSE_RANK() OVER(ORDER BY USERS_NUMBER DESC) FROM
(SELECT DISTINCT SONG_NAME, ARTIST_NAME, SONG_LEVEL, COUNT(USER_ID) OVER (PARTITION BY SONG_NAME) USERS_NUMBER
FROM EVENTS
WHERE SONG_PLAYED = 'NextSong') SUB_QUERY_1
WHERE SONG_NAME IS NOT NULL ;