-- SONGS ID THE USERS HEAR THE MOST ORDERD FORM THE MOST ONE TO THE LOWEST AND THE ARTIST OF EACH SONG

SELECT * FROM
(
 SELECT SONG_ID, S.SONG_NAME, S.ARTIST_ID, E.ARTIST_NAME, E.SONG_LENGTH_IN_SECONDS, 
COUNT(USER_ID) OVER(PARTITION BY SONG_ID) USERS_NUMBER
FROM EVENTS E, SONGS S
WHERE E.SONG_NAME = S.SONG_NAME AND SONG_PLAYED = 'NextSong'
	) SUB_QUERY ORDER BY USERS_NUMBER DESC;